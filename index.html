<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>Abdo TV - ÿßŸÑÿ®ÿ´ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap');

    * {
        font-family: 'Cairo', sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    :root {
        --primary: #9D4EDD;
        --primary-dark: #7B2CBF;
        --primary-light: #C77DFF;
        --bg-light: #FFFFFF;
        --text-primary: #1A1A1A;
        --text-secondary: #666666;
        --shadow: rgba(157, 78, 221, 0.1);
    }

    body {
        background: #FFFFFF;
        color: var(--text-primary);
        min-height: 100vh;
        padding-bottom: 80px;
        overflow-x: hidden;
    }

    ::selection {
        background: transparent;
    }

    /* Focus styles for remote/keyboard navigation */
    *:focus {
        outline: none;
    }

    *:focus-visible {
        outline: 3px solid var(--primary);
        outline-offset: 3px;
        box-shadow: 0 0 0 6px rgba(157, 78, 221, 0.2);
        z-index: 10;
    }

    .card:focus-visible,
    .nav-tab:focus-visible,
    .server-option:focus-visible,
    button:focus-visible {
        transform: scale(1.05);
        box-shadow: 0 0 0 4px rgba(157, 78, 221, 0.3), 0 8px 24px rgba(157, 78, 221, 0.3);
        border-color: var(--primary);
    }

    /* Maintenance and Update Pages */
    .maintenance-page,
    .update-page {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        padding: 2rem;
    }

    .maintenance-page.active,
    .update-page.active {
        display: flex;
    }

    .maintenance-content,
    .update-content {
        text-align: center;
        color: white;
        max-width: 600px;
        animation: slideUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .maintenance-icon {
        font-size: 5rem;
        margin-bottom: 2rem;
        animation: pulse 2s ease-in-out infinite;
    }

    .maintenance-title,
    .update-title {
        font-size: 2.5rem;
        font-weight: 900;
        margin-bottom: 1rem;
    }

    .maintenance-desc,
    .update-desc {
        font-size: 1.125rem;
        margin-bottom: 1.5rem;
        opacity: 0.9;
    }

    .maintenance-info {
        background: rgba(255, 255, 255, 0.1);
        padding: 1.5rem;
        border-radius: 16px;
        margin: 2rem 0;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .maintenance-social {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 2rem;
    }

    .social-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .social-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-5px);
    }

    .update-version {
        font-size: 1.2rem;
        font-weight: 700;
        margin: 1rem 0;
        background: rgba(255, 255, 255, 0.2);
        padding: 0.5rem 1rem;
        border-radius: 10px;
        display: inline-block;
    }

    .download-btn {
        padding: 1rem 2.5rem;
        background: white;
        color: var(--primary);
        border: none;
        border-radius: 12px;
        font-weight: 900;
        font-size: 1.125rem;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 2rem;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        text-decoration: none;
    }

    .download-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .progress-bar {
        width: 300px;
        height: 4px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        margin-top: 2rem;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: white;
        border-radius: 10px;
        animation: progress 2s ease-in-out infinite;
    }

    @keyframes progress {
        0% { width: 0%; }
        50% { width: 100%; }
        100% { width: 100%; }
    }

    .update-features {
        background: rgba(255, 255, 255, 0.1);
        padding: 1.5rem;
        border-radius: 16px;
        margin: 2rem 0;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        text-align: right;
    }

    /* Loading Screen */
    .loading-screen {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
    }

    .loading-logo {
        font-size: 4rem;
        margin-bottom: 2rem;
        animation: pulse 2s ease-in-out infinite;
        color: white;
        width: 120px;
        height: 120px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .loading-text {
        font-size: 2rem;
        font-weight: 900;
        color: white;
    }

    .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-top: 2rem;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(50px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Header - ŸÖÿ≠ÿ≥ŸëŸÜ ŸÑŸÑŸáŸàÿßÿ™ŸÅ */
    .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        padding: 0.8rem 0;
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 2px solid rgba(157, 78, 221, 0.15);
        box-shadow: 0 4px 20px var(--shadow);
    }

    .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 1rem;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        position: relative;
        height: 50px;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 0.8rem;
        font-size: 1.3rem;
        font-weight: 900;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        transition: opacity 0.3s ease;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
    }

    .logo.hidden {
        opacity: 0;
        pointer-events: none;
    }

    .logo i {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        -webkit-text-fill-color: white;
        font-size: 1.2rem;
        box-shadow: 0 4px 16px rgba(157, 78, 221, 0.3);
    }

    .header-title {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.2rem;
        font-weight: 900;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        white-space: nowrap;
        max-width: 50%;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .header-title.active {
        opacity: 1;
    }

    .header-actions {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        margin-right: auto;
    }

    .back-btn-header,
    .menu-btn,
    .search-btn,
    .support-btn {
        width: 36px;
        height: 36px;
        border-radius: 12px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border: none;
        color: white;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .back-btn-header {
        display: none;
        margin-right: 8px;
    }

    .back-btn-header.active {
        display: flex;
    }

    .search-btn {
        margin-right: 8px;
    }

    .support-btn {
        margin-right: 8px;
        display: none;
    }

    .support-btn.active {
        display: flex;
    }

    .menu-btn.hidden,
    .header-content.hide-search .search-btn {
        display: none;
    }

    .back-btn-header:hover,
    .menu-btn:hover,
    .search-btn:hover,
    .support-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.4);
    }

    .back-btn-header:active,
    .menu-btn:active,
    .search-btn:active,
    .support-btn:active {
        transform: scale(0.95);
    }

    /* Moving Text */
    .moving-text-container {
        background: #FFFFFF;
        overflow: hidden;
        position: relative;
        height: 50px;
        display: flex;
        align-items: center;
        border-bottom: 2px solid rgba(157, 78, 221, 0.15);
        box-shadow: 0 4px 15px rgba(157, 78, 221, 0.1);
    }

    .moving-text-container::before,
    .moving-text-container::after {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        width: 80px;
        z-index: 2;
        pointer-events: none;
    }

    .moving-text-container::before {
        left: 0;
        background: linear-gradient(to right, rgba(255, 255, 255, 0.95), transparent);
    }

    .moving-text-container::after {
        right: 0;
        background: linear-gradient(to left, rgba(255, 255, 255, 0.95), transparent);
    }

    .moving-text {
        position: absolute;
        top: 50%;
        left: 0;
        transform: translateY(-50%);
        white-space: nowrap;
        font-size: 1.25rem;
        font-weight: 900;
        color: #9D4EDD;
        letter-spacing: 0.5px;
        text-shadow: 0 2px 10px rgba(157, 78, 221, 0.3);
        filter: drop-shadow(0 2px 4px rgba(157, 78, 221, 0.2));
        animation: smoothMove 18s linear infinite;
    }

    @keyframes smoothMove {
        0% { transform: translateX(-100%) translateY(-50%); }
        100% { transform: translateX(100vw) translateY(-50%); }
    }

    /* Bottom Navigation */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        border-top: 2px solid rgba(157, 78, 221, 0.15);
        box-shadow: 0 -4px 20px var(--shadow);
        z-index: 100;
        transition: transform 0.3s ease;
    }

    .bottom-nav.hidden {
        transform: translateY(100%);
    }

    .nav-tabs {
        display: flex;
        justify-content: space-around;
        align-items: center;
        max-width: 1400px;
        margin: 0 auto;
        padding: 0.5rem;
    }

    .nav-tab {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.35rem;
        padding: 0.75rem;
        border-radius: 16px;
        font-weight: 700;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
        background: transparent;
        color: var(--text-secondary);
        position: relative;
    }

    .nav-tab i {
        font-size: 1.5rem;
        transition: all 0.3s ease;
    }

    .nav-tab:active {
        transform: scale(0.9);
    }

    .nav-tab.active {
        color: var(--primary);
    }

    .nav-tab.active i {
        transform: translateY(-3px);
    }

    .nav-tab.active::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 40px;
        height: 3px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border-radius: 0 0 8px 8px;
        animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
        from {
            transform: translateX(-50%) translateY(-10px);
            opacity: 0;
        }
        to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    }

    /* Side Menu - ŸÖÿ≠ÿ≥ŸëŸÜ Ÿàÿ£ÿµÿ∫ÿ± */
    .side-menu {
        position: fixed;
        top: 0;
        right: -100%;
        width: 260px;
        height: 100vh;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        box-shadow: -4px 0 30px rgba(157, 78, 221, 0.15);
        z-index: 1001;
        transition: right 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        overflow-y: auto;
    }

    .side-menu.active {
        right: 0;
        animation: menuSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes menuSlideIn {
        0% {
            right: -100%;
            opacity: 0;
        }
        100% {
            right: 0;
            opacity: 1;
        }
    }

    .side-menu-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(4px);
    }

    .side-menu-overlay.active {
        opacity: 1;
        visibility: visible;
    }

    .side-menu-header {
        padding: 1.5rem 1.2rem;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
    }

    .side-menu-title {
        font-size: 1.3rem;
        font-weight: 900;
        margin-bottom: 0.4rem;
    }

    .side-menu-subtitle {
        font-size: 0.8rem;
        opacity: 0.9;
    }

    .side-menu-content {
        padding: 1.2rem;
    }

    .menu-section {
        margin-bottom: 1.5rem;
    }

    .menu-section-title {
        font-size: 0.8rem;
        font-weight: 700;
        color: var(--text-secondary);
        margin-bottom: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .social-links {
        display: grid;
        gap: 0.65rem;
    }

    .social-link {
        display: flex;
        align-items: center;
        gap: 0.8rem;
        padding: 0.8rem;
        border-radius: 12px;
        background: #FFFFFF;
        transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        text-decoration: none;
        color: #1A1A1A;
        border: 2px solid rgba(157, 78, 221, 0.15);
    }

    .social-link:hover {
        border-color: var(--primary);
        transform: translateX(-5px) scale(1.03);
        box-shadow: 0 6px 16px rgba(157, 78, 221, 0.2);
    }

    .social-link:active {
        transform: translateX(-3px) scale(0.98);
    }

    .social-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        color: white;
        flex-shrink: 0;
    }

    .social-name {
        font-weight: 700;
        flex: 1;
        font-size: 0.95rem;
    }

    /* Container */
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 1.5rem 1rem;
    }

    /* Section */
    .section {
        display: none;
        animation: fadeInUp 0.5s ease;
    }

    .section.active {
        display: block;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Cards */
    .card {
        background: #FFFFFF;
        border-radius: 16px;
        padding: 1rem;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid rgba(157, 78, 221, 0.1);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(157, 78, 221, 0.08);
        margin-bottom: 0.75rem;
    }

    .card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(157, 78, 221, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .card::after {
        content: '‚úì';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-size: 2.5rem;
        font-weight: 900;
        color: var(--primary);
        opacity: 0;
        transition: all 0.2s ease;
        pointer-events: none;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 24px rgba(157, 78, 221, 0.15);
        border-color: var(--primary);
    }

    .card:hover::before {
        opacity: 1;
    }

    .card:active {
        transform: translateY(-1px) scale(0.98);
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.12);
    }

    .card.pressed::after {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
        animation: checkMark 0.4s ease;
    }

    @keyframes checkMark {
        0% {
            transform: translate(-50%, -50%) scale(0) rotate(-45deg);
            opacity: 0;
        }
        50% {
            transform: translate(-50%, -50%) scale(1.2) rotate(0deg);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -50%) scale(0) rotate(45deg);
            opacity: 0;
        }
    }

    /* Package Card */
    .package-card {
        position: relative;
        min-height: 80px;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        gap: 0.75rem;
        padding: 0.875rem;
    }

    .package-icon {
        width: 55px;
        height: 55px;
        border-radius: 12px;
        object-fit: cover;
        flex-shrink: 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .card:active .package-icon,
    .card:active .package-icon-placeholder {
        transform: scale(0.9);
    }

    .package-icon-placeholder {
        width: 55px;
        height: 55px;
        border-radius: 12px;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        background: rgba(157, 78, 221, 0.15);
        transition: transform 0.3s ease;
    }

    .package-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 0.2rem;
        text-align: center;
        min-width: 0;
    }

    .package-name {
        font-size: 1.3rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        line-height: 1.2;
    }

    .package-desc {
        font-size: 0.75rem;
        color: var(--text-secondary);
        line-height: 1.3;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .package-arrow {
        width: 32px;
        height: 32px;
        border-radius: 10px;
        background: rgba(157, 78, 221, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary);
        font-size: 0.9rem;
        flex-shrink: 0;
        transition: all 0.3s ease;
    }

    .card:hover .package-arrow {
        background: var(--primary);
        color: white;
        transform: translateX(-5px);
    }

    .card:active .package-arrow {
        transform: translateX(-2px) scale(0.9);
    }

    /* Channel Card */
    .channel-card {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        position: relative;
        padding: 0.875rem;
    }

    .channel-icon {
        width: 55px;
        height: 55px;
        border-radius: 12px;
        object-fit: cover;
        flex-shrink: 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .card:active .channel-icon,
    .card:active .channel-icon-placeholder {
        transform: scale(0.9);
    }

    .channel-icon-placeholder {
        width: 55px;
        height: 55px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.75rem;
        background: rgba(157, 78, 221, 0.15);
        flex-shrink: 0;
        transition: transform 0.3s ease;
    }

    .channel-info {
        flex: 1;
        text-align: center;
        min-width: 0;
    }

    .channel-name {
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
        color: #9D4EDD;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .channel-quality {
        display: flex;
        gap: 0.4rem;
        flex-wrap: wrap;
        justify-content: center;
    }

    .quality-badge {
        padding: 0.2rem 0.6rem;
        border-radius: 6px;
        font-size: 0.7rem;
        font-weight: 700;
        background: rgba(16, 185, 129, 0.2);
        color: #10B981;
    }

    /* Favorite Button */
    .favorite-btn {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: rgba(239, 68, 68, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        color: #EF4444;
        flex-shrink: 0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 2px solid rgba(239, 68, 68, 0.2);
        cursor: pointer;
        z-index: 10;
    }

    .favorite-btn:hover {
        background: rgba(239, 68, 68, 0.2);
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .favorite-btn:active {
        transform: scale(0.95);
    }

    .favorite-btn.active {
        background: linear-gradient(135deg, #EF4444, #DC2626);
        color: white;
        border-color: #EF4444;
        animation: heartBeat 0.5s ease;
    }

    @keyframes heartBeat {
        0%, 100% { transform: scale(1); }
        25% { transform: scale(1.3); }
        50% { transform: scale(1.1); }
        75% { transform: scale(1.25); }
    }

    /* Match Card */
    .match-card {
        position: relative;
        padding: 0.75rem;
    }

    .match-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .match-teams {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 0.75rem;
        gap: 0.5rem;
    }

    .team {
        flex: 0 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.6rem;
        width: 32%;
    }

    .match-time-container {
        flex: 1;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-width: 30%;
    }

    .team-logo {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        background: #FFFFFF;
        border: none;
        box-shadow: none;
        flex-shrink: 0;
        transition: transform 0.3s ease;
    }

    .card:active .team-logo {
        transform: scale(0.95);
    }

    .team-logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        border-radius: 12px;
        box-shadow: none;
        border: none;
    }

    .team-name {
        font-size: 0.85rem;
        font-weight: 800;
        color: var(--text-primary);
        line-height: 1.2;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .match-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 0.75rem;
        border-top: 2px solid rgba(157, 78, 221, 0.1);
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .match-channel {
        font-size: 0.75rem;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        gap: 0.4rem;
    }

    .match-commentator {
        font-size: 0.75rem;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-weight: 600;
    }

    .match-commentator i {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .live-badge {
        position: absolute;
        top: 0.75rem;
        left: 0.75rem;
        padding: 0.35rem 0.75rem;
        border-radius: 8px;
        background: linear-gradient(135deg, #EF4444, #DC2626);
        color: white;
        font-weight: 700;
        font-size: 0.75rem;
        display: flex;
        align-items: center;
        gap: 0.4rem;
        animation: livePulse 2s ease-in-out infinite;
    }

    @keyframes livePulse {
        0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
        50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
    }

    .live-dot {
        width: 7px;
        height: 7px;
        border-radius: 50%;
        background: white;
        animation: blink 1s ease-in-out infinite;
    }

    @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.3; }
    }

    /* Match Time Styles */
    .match-time-container {
        text-align: center;
        margin: 0.4rem 0;
        padding: 0.4rem;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

    .match-time {
        font-size: 0.9rem;
        font-weight: 700;
        color: #9D4EDD;
    }

    .match-time.live {
        background: linear-gradient(135deg, #EF4444, #DC2626);
        color: white;
        animation: liveGlow 2s ease-in-out infinite;
        box-shadow: 0 3px 12px rgba(239, 68, 68, 0.4);
        padding: 0.5rem;
        border-radius: 8px;
        margin: 0.4rem 0;
        font-size: 0.85rem;
    }

    .match-time.ended {
        background: #6B7280;
        color: white;
        padding: 0.5rem;
        border-radius: 8px;
        margin: 0.4rem 0;
        font-size: 0.85rem;
    }

    .live-score {
        font-size: 1.1rem;
        font-weight: 900;
        color: #EF4444;
        animation: scorePulse 1.5s ease-in-out infinite;
        margin: 0.4rem 0;
    }

    .default-score {
        font-size: 0.9rem;
        font-weight: 600;
        color: #9D4EDD;
        margin: 0.4rem 0;
        display: none;
    }

    @keyframes liveGlow {
        0%, 100% {
            box-shadow: 0 3px 12px rgba(239, 68, 68, 0.4);
            transform: scale(1);
        }
        50% {
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.6);
            transform: scale(1.02);
        }
    }

    @keyframes scorePulse {
        0%, 100% {
            opacity: 1;
            transform: scale(1);
        }
        50% {
            opacity: 0.8;
            transform: scale(1.05);
        }
    }

    /* Server Popup Styles - ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÉÿ®Ÿäÿ± */
    .server-popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 1rem;
        backdrop-filter: blur(8px);
        animation: overlayFadeIn 0.3s ease;
    }

    @keyframes overlayFadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    .server-popup {
        background: white;
        border-radius: 24px;
        width: 100%;
        max-width: 420px;
        max-height: 85vh;
        overflow: hidden;
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.4);
        animation: popupSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes popupSlideIn {
        from {
            opacity: 0;
            transform: translateY(60px) scale(0.9);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .server-popup-header {
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        padding: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.3);
    }

    .server-popup-header h3 {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 800;
        flex: 1;
        padding-left: 1rem;
    }

    .close-popup {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        width: 38px;
        height: 38px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        flex-shrink: 0;
    }

    .close-popup:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
    }

    .server-popup-content {
        padding: 1.25rem;
        max-height: calc(85vh - 90px);
        overflow-y: auto;
    }

    .server-option {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.1rem;
        margin-bottom: 0.75rem;
        background: linear-gradient(135deg, #f8fafc, #ffffff);
        border: 2px solid #e2e8f0;
        border-radius: 16px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        position: relative;
        overflow: hidden;
    }

    .server-option::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(157, 78, 221, 0.1), transparent);
        transition: left 0.5s ease;
    }

    .server-option:hover {
        border-color: var(--primary);
        background: linear-gradient(135deg, #ffffff, #faf5ff);
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 8px 20px rgba(157, 78, 221, 0.25);
    }

    .server-option:hover::before {
        left: 100%;
    }

    .server-option:active {
        transform: translateY(-2px) scale(0.98);
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.2);
    }

    .server-info {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .server-label {
        display: block;
        font-weight: 800;
        color: var(--text-primary);
        font-size: 1.1rem;
        transition: color 0.3s ease;
    }

    .server-option:hover .server-label {
        color: var(--primary);
    }

    .server-quality-hint {
        font-size: 0.75rem;
        color: var(--text-secondary);
        font-weight: 600;
    }

    .open-indicator {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        flex-shrink: 0;
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.3);
    }

    .server-option:hover .open-indicator {
        background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        transform: scale(1.15) rotate(15deg);
        box-shadow: 0 6px 18px rgba(157, 78, 221, 0.4);
    }

    .server-option:active .open-indicator {
        transform: scale(1.05) rotate(10deg);
    }

    /* Support Popup Styles */
    .support-popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 1rem;
        backdrop-filter: blur(8px);
        animation: overlayFadeIn 0.3s ease;
    }

    .support-popup {
        background: white;
        border-radius: 24px;
        width: 100%;
        max-width: 420px;
        max-height: 85vh;
        overflow: hidden;
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.4);
        animation: popupSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .support-popup-header {
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        padding: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.3);
    }

    .support-popup-header h3 {
        margin: 0;
        font-size: 1.2rem;
        font-weight: 800;
        flex: 1;
        padding-left: 1rem;
    }

    .support-popup-content {
        padding: 1.5rem;
    }

    .support-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-label {
        font-weight: 700;
        color: var(--text-primary);
        font-size: 0.9rem;
    }

    .form-input {
        padding: 0.9rem;
        border: 2px solid rgba(157, 78, 221, 0.2);
        border-radius: 12px;
        font-size: 1rem;
        background: #FFFFFF;
        transition: all 0.3s ease;
        text-align: right;
    }

    .form-input:focus {
        outline: none;
        border-color: #9D4EDD;
        box-shadow: 0 0 0 3px rgba(157, 78, 221, 0.2);
    }

    .char-counter {
        font-size: 0.75rem;
        color: var(--text-secondary);
        text-align: left;
    }

    .submit-btn {
        padding: 1rem;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        color: white;
        border: none;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 0.5rem;
    }

    .submit-btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(157, 78, 221, 0.4);
    }

    .submit-btn:active:not(:disabled) {
        transform: translateY(0);
    }

    .submit-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 3rem 1.5rem;
        color: var(--text-secondary);
    }

    .empty-state i {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.3;
    }

    .empty-state h3 {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 0.4rem;
    }

    .empty-state p {
        font-size: 0.95rem;
    }

    /* Back Button */
    .back-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1.5rem;
        margin-bottom: 2rem;
        border-radius: 12px;
        background: rgba(157, 78, 221, 0.15);
        border: 2px solid var(--primary);
        color: var(--primary);
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .back-btn:hover {
        background: var(--primary);
        color: white;
        transform: translateX(5px);
    }

    .back-btn:active {
        transform: translateX(3px) scale(0.98);
    }

    /* Section Title */
    .section-title {
        font-size: 1.3rem;
        font-weight: 900;
        margin-bottom: 0.75rem;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-align: center;
    }

    .section-subtitle {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 1.5rem;
        text-align: center;
    }

    /* Search Page */
    .search-page-header {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .search-page-header .back-btn {
        width: 48px;
        height: 48px;
        border-radius: 14px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border: none;
        color: white;
        font-size: 1.4rem;
        margin-bottom: 0;
        padding: 0;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 4px 12px rgba(157, 78, 221, 0.3);
    }

    .search-page-header .back-btn:hover {
        transform: scale(1.1) translateX(3px);
        box-shadow: 0 6px 18px rgba(157, 78, 221, 0.4);
    }

    .search-page-header .back-btn:active {
        transform: scale(0.95);
    }

    .search-input-container {
        position: relative;
        margin-bottom: 1.5rem;
    }

    .search-page-input {
        width: 100%;
        padding: 0.9rem 2.8rem 0.9rem 0.9rem;
        border: 2px solid rgba(157, 78, 221, 0.3);
        border-radius: 14px;
        font-size: 1rem;
        font-weight: 600;
        background: #FFFFFF;
        transition: all 0.3s ease;
        text-align: right;
        box-shadow: 0 2px 10px rgba(157, 78, 221, 0.08);
    }

    .search-page-input:focus {
        outline: none;
        border-color: #9D4EDD;
        box-shadow: 0 0 0 3px rgba(157, 78, 221, 0.2);
    }

    .search-icon {
        position: absolute;
        left: 0.9rem;
        top: 50%;
        transform: translateY(-50%);
        color: #9D4EDD;
        font-size: 1.1rem;
    }

    .search-page-result-item {
        background: #FFFFFF;
        border-radius: 14px;
        padding: 0.875rem;
        margin-bottom: 0.75rem;
        border: 2px solid rgba(157, 78, 221, 0.1);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .search-page-result-item:hover {
        transform: translateY(-3px);
        border-color: #9D4EDD;
        box-shadow: 0 6px 20px rgba(157, 78, 221, 0.15);
    }

    .search-page-result-item:active {
        transform: translateY(-1px) scale(0.995);
    }

    .search-page-no-results {
        text-align: center;
        padding: 3rem 1.5rem;
        color: #666;
    }

    .search-page-no-results i {
        font-size: 3.5rem;
        margin-bottom: 1rem;
        opacity: 0.3;
    }

    .search-page-no-results h3 {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 0.4rem;
    }

    .search-page-no-results p {
        font-size: 0.95rem;
    }

    /* Ripple Effect */
    .ripple {
        position: relative;
        overflow: hidden;
    }

    .ripple::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(157, 78, 221, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }

    .ripple:active::after {
        width: 300px;
        height: 300px;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .container {
            padding: 1.25rem 0.875rem;
        }

        .logo {
            font-size: 1.2rem;
            gap: 0.7rem;
        }

        .logo i {
            width: 34px;
            height: 34px;
            font-size: 1.1rem;
        }

        .header-title {
            font-size: 1.1rem;
        }

        .section-title {
            font-size: 1.2rem;
        }

        .section-subtitle {
            font-size: 0.85rem;
        }

        .side-menu {
            width: 240px;
        }

        .moving-text {
            font-size: 1.1rem;
        }

        .package-name {
            font-size: 1.2rem;
        }

        .package-desc {
            font-size: 0.7rem;
        }

        .channel-name {
            font-size: 1.1rem;
        }

        .team-name {
            font-size: 0.8rem;
        }

        .team-logo {
            width: 55px;
            height: 55px;
            font-size: 1.8rem;
        }

        .match-time {
            font-size: 0.85rem;
        }

        .live-score {
            font-size: 1rem;
        }

        .server-popup {
            max-width: 95%;
        }

        .server-option {
            padding: 1rem;
        }

        .server-label {
            font-size: 1rem;
        }

        .support-popup {
            max-width: 95%;
        }
    }

    @media (max-width: 480px) {
        .container {
            padding: 1rem 0.75rem;
        }

        .logo {
            font-size: 1.1rem;
        }

        .logo i {
            width: 32px;
            height: 32px;
            font-size: 1rem;
        }

        .header-title {
            font-size: 1rem;
        }

        .header-content {
            height: 48px;
        }

        .back-btn-header,
        .menu-btn,
        .search-btn,
        .support-btn {
            width: 34px;
            height: 34px;
            font-size: 1.1rem;
        }

        .package-card {
            min-height: 75px;
            padding: 0.75rem;
        }

        .package-icon,
        .package-icon-placeholder {
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
        }

        .package-name {
            font-size: 1.1rem;
        }

        .package-desc {
            font-size: 0.68rem;
        }

        .package-arrow {
            width: 30px;
            height: 30px;
            font-size: 0.85rem;
        }

        .channel-card {
            padding: 0.75rem;
        }

        .channel-icon,
        .channel-icon-placeholder {
            width: 50px;
            height: 50px;
            font-size: 1.6rem;
        }

        .channel-name {
            font-size: 1rem;
        }

        .quality-badge {
            padding: 0.18rem 0.5rem;
            font-size: 0.65rem;
        }

        .favorite-btn {
            width: 38px;
            height: 38px;
            font-size: 1rem;
        }

        .match-card {
            padding: 0.65rem;
        }

        .team {
            width: 30%;
        }

        .team-logo {
            width: 50px;
            height: 50px;
            font-size: 1.6rem;
        }

        .team-name {
            font-size: 0.75rem;
        }

        .match-time,
        .match-time.live,
        .match-time.ended {
            font-size: 0.8rem;
            padding: 0.4rem;
        }

        .live-score {
            font-size: 0.95rem;
        }

        .match-channel,
        .match-commentator {
            font-size: 0.7rem;
        }

        .live-badge {
            padding: 0.3rem 0.65rem;
            font-size: 0.7rem;
        }

        .section-title {
            font-size: 1.1rem;
        }

        .section-subtitle {
            font-size: 0.8rem;
            margin-bottom: 1.25rem;
        }

        .server-popup-header h3 {
            font-size: 1.1rem;
        }

        .server-option {
            padding: 0.9rem;
        }

        .server-label {
            font-size: 0.95rem;
        }

        .server-quality-hint {
            font-size: 0.7rem;
        }

        .open-indicator {
            width: 36px;
            height: 36px;
            font-size: 1rem;
        }

        .side-menu {
            width: 220px;
        }

        .side-menu-title {
            font-size: 1.2rem;
        }

        .social-name {
            font-size: 0.9rem;
        }

        .social-icon {
            width: 38px;
            height: 38px;
            font-size: 1rem;
        }

        .support-popup-header h3 {
            font-size: 1.1rem;
        }

        .support-popup-content {
            padding: 1.25rem;
        }
    }

    @media (max-width: 360px) {
        .package-name {
            font-size: 1rem;
        }

        .channel-name {
            font-size: 0.95rem;
        }

        .team-logo {
            width: 45px;
            height: 45px;
        }

        .team-name {
            font-size: 0.7rem;
        }

        .side-menu {
            width: 200px;
        }
    }

    #channelsSectionTitle {
        display: none !important;
    }
</style>
</head>
<body>
<!-- Maintenance Page -->
<div class="maintenance-page" id="maintenancePage">
<div class="maintenance-content">
<div class="maintenance-icon">üîß</div>
<h1 class="maintenance-title">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿµŸäÿßŸÜÿ©</h1>
<p class="maintenance-desc" id="maintenanceMessageDisplay">ŸÜÿπÿ™ÿ∞ÿ± ÿπŸÜ ÿßŸÜŸÇÿ∑ÿßÿπ ÿßŸÑÿÆÿØŸÖÿ© ÿ≠ÿßŸÑŸäÿßŸã</p>
<div class="maintenance-info">
<p>ÿ≥ŸÜÿπŸàÿØ ŸÇÿ±Ÿäÿ®ÿßŸã ÿ®ÿ±ŸÅÿπ ÿ¨ÿØŸäÿØ Ÿàÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™</p>
<p style="font-size: 0.9rem; margin-top: 1rem;">ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ™ŸàŸÇÿπ ŸÑŸÑÿπŸàÿØÿ©: <span id="maintenanceTimeDisplay">ŸÇÿ±Ÿäÿ®ÿßŸã ÿ¨ÿØÿßŸã</span></p>
</div>
<div class="maintenance-social">
<a class="social-btn" href="https://t.me/abdotv" target="_blank"><i class="fab fa-telegram"></i></a>
<a class="social-btn" href="https://www.instagram.com/abdotv" target="_blank"><i class="fab fa-instagram"></i></a>
<a class="social-btn" href="https://www.facebook.com/abdotv" target="_blank"><i class="fab fa-facebook"></i></a>
</div>
</div>
</div>

<!-- Update Page -->
<div class="update-page" id="updatePage">
<div class="update-content">
<div class="maintenance-icon">üì±</div>
<h1 class="update-title">ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿ™ÿßÿ≠</h1>
<p class="update-desc" id="updateDescriptionDisplay">ŸäŸàÿ¨ÿØ ÿ™ÿ≠ÿØŸäÿ´ ÿ¨ÿØŸäÿØ ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ</p>
<div class="update-version" id="updateVersionDisplay">ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿ¨ÿØŸäÿØ: 2.0.0</div>
<div class="update-features">
<p id="updateFeaturesDisplay">ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ° ŸàŸÖŸäÿ≤ÿßÿ™ ÿ¨ÿØŸäÿØÿ©</p>
</div>
<a class="download-btn" href="#" id="downloadLink">
<i class="fas fa-download"></i>
ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´
</a>
<div class="progress-bar">
<div class="progress-fill"></div>
</div>
</div>
</div>

<!-- Loading Screen -->
<div class="loading-screen" id="loadingScreen">
<div class="loading-logo">
<i class="fas fa-tv"></i>
</div>
<h1 class="loading-text">Abdo TV</h1>
<p class="text-xl mb-4" style="color: white;">ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ...</p>
<div class="loading-spinner"></div>
</div>

<!-- Side Menu Overlay -->
<div class="side-menu-overlay" id="sideMenuOverlay"></div>

<!-- Side Menu -->
<div class="side-menu" id="sideMenu">
<div class="side-menu-header">
<h2 class="side-menu-title">Abdo TV</h2>
<p class="side-menu-subtitle">ÿ™ÿßÿ®ÿπŸÜÿß ÿπŸÑŸâ Ÿàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑÿßÿ¨ÿ™ŸÖÿßÿπŸä</p>
</div>
<div class="side-menu-content">
<div class="menu-section">
<h3 class="menu-section-title">ÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑÿ™ŸàÿßÿµŸÑ</h3>
<div class="social-links">
<a class="social-link ripple" href="https://t.me/abdotv" rel="noopener" target="_blank">
<div class="social-icon" style="background: linear-gradient(135deg, #0088cc, #00A0E9);">
<i class="fab fa-telegram"></i>
</div>
<span class="social-name">ÿ™ŸäŸÑŸäÿ¨ÿ±ÿßŸÖ</span>
<i class="fas fa-arrow-left" style="color: var(--text-secondary);"></i>
</a>
<a class="social-link ripple" href="https://www.tiktok.com/@abdotv" rel="noopener" target="_blank">
<div class="social-icon" style="background: linear-gradient(135deg, #000000, #333333);">
<i class="fab fa-tiktok"></i>
</div>
<span class="social-name">ÿ™ŸäŸÉ ÿ™ŸàŸÉ</span>
<i class="fas fa-arrow-left" style="color: var(--text-secondary);"></i>
</a>
<a class="social-link ripple" href="https://www.youtube.com/@abdotv" rel="noopener" target="_blank">
<div class="social-icon" style="background: linear-gradient(135deg, #FF0000, #CC0000);">
<i class="fab fa-youtube"></i>
</div>
<span class="social-name">ŸäŸàÿ™ŸäŸàÿ®</span>
<i class="fas fa-arrow-left" style="color: var(--text-secondary);"></i>
</a>
</div>
</div>
</div>
</div>

<!-- Header -->
<header class="header">
<div class="header-content">
<button class="search-btn ripple" id="searchBtn" tabindex="0">
<i class="fas fa-search"></i>
</button>

<button class="back-btn-header ripple" id="backBtnHeader" tabindex="0">
<i class="fas fa-arrow-right"></i>
</button>

<button class="support-btn ripple" id="supportBtn" tabindex="0">
<i class="fas fa-headset"></i>
</button>

<div class="logo" id="headerLogo">
<i class="fas fa-tv"></i>
<span>Abdo TV</span>
</div>

<h2 class="header-title" id="headerTitle">ÿßŸÑŸÇŸÜŸàÿßÿ™</h2>

<div class="header-actions">
<button class="menu-btn ripple" id="menuBtn" tabindex="0">
<i class="fas fa-bars"></i>
</button>
</div>
</div>
</header>

<!-- Moving Text -->
<div class="moving-text-container" id="movingTextContainer">
<div class="moving-text" id="movingText"></div>
</div>

<!-- Main Container -->
<div class="container">
<!-- Home Section -->
<section class="section active" id="homeSection">
<h1 class="section-title"></h1>
<p class="section-subtitle">ÿßÿÆÿ™ÿ± ÿ®ÿßŸÇÿ™ŸÉ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© Ÿàÿßÿ≥ÿ™ŸÖÿ™ÿπ ÿ®ÿ£ŸÅÿ∂ŸÑ ÿßŸÑŸÇŸÜŸàÿßÿ™</p>
<div id="featuredPackages"></div>
</section>

<!-- Channels Section -->
<section class="section" id="channelsSection">
<h1 class="section-title" id="channelsSectionTitle">ÿßŸÑŸÇŸÜŸàÿßÿ™</h1>
<div id="channelsGrid"></div>
</section>

<!-- Matches Section -->
<section class="section" id="matchesSection">
<h1 class="section-title" id="matchesSectionTitle">ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸäŸàŸÖ</h1>
<div id="matchesGrid"></div>
</section>

<!-- Favorites Section -->
<section class="section" id="favoritesSection">
<p class="section-subtitle">ŸÇŸÜŸàÿßÿ™ŸÉ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ŸÅŸä ŸÖŸÉÿßŸÜ Ÿàÿßÿ≠ÿØ</p>
<div id="favoritesGrid"></div>
</section>

<!-- Search Section -->
<section class="section" id="searchSection">
<div class="search-page-header">
<button class="back-btn ripple" onclick="goBackFromSearch()" tabindex="0">
<i class="fas fa-arrow-right"></i>
</button>
<h1 class="section-title" style="margin-bottom: 0; flex: 1;">ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÇŸÜŸàÿßÿ™</h1>
</div>

<div class="search-input-container">
<input type="text" class="search-page-input" id="searchPageInput" placeholder="ÿßŸÉÿ™ÿ® ÿßÿ≥ŸÖ ÿßŸÑŸÇŸÜÿßÿ© ŸÑŸÑÿ®ÿ≠ÿ´..." dir="rtl" autocomplete="off" tabindex="0">
<i class="fas fa-search search-icon"></i>
</div>

<div class="search-results-container" id="searchPageResults"></div>
</section>
</div>

<!-- Bottom Navigation -->
<nav class="bottom-nav" id="bottomNav">
<div class="nav-tabs">
<button class="nav-tab active ripple" data-section="home" tabindex="0">
<i class="fas fa-home"></i>
<span>ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</span>
</button>
<button class="nav-tab ripple" data-section="matches" tabindex="0">
<i class="fas fa-futbol"></i>
<span>ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™</span>
</button>
<button class="nav-tab ripple" data-section="favorites" tabindex="0">
<i class="fas fa-heart"></i>
<span>ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©</span>
</button>
</div>
</nav>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('selectstart', e => e.preventDefault());
  document.addEventListener('copy', e => e.preventDefault());
  document.addEventListener('cut', e => e.preventDefault());

  const firebaseConfig = {
            apiKey: "AIzaSyBhKc2bEIaDTJ1ZlMla1Jzj3VMhK2fxD7Y",
            authDomain: "infinity-tv-477bc-default-rtdb.firebaseio.com",
            databaseURL: "https://infinity-tv-477bc-default-rtdb.firebaseio.com",
            projectId: "infinity-tv-477bc",
            storageBucket: "infinity-tv-477basestorage.app",
            messagingSenderId: "364967685336",
            appId: "1:364967685336:android:d1138644b96bbfe8093bad"
        };

  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  let packages = {};
  let channels = {};
  let matches = {};
  let matchResults = {};
  let favorites = loadFavorites();
  let currentPackageId = null;
  let currentPackageName = '';
  let matchTimers = {};
  let lastSupportSubmit = localStorage.getItem('lastSupportSubmit') || 0;

  // Support Functions
  function showSupportPopup() {
      const popup = document.createElement('div');
      popup.className = 'support-popup-overlay';
      popup.innerHTML = `
          <div class="support-popup">
              <div class="support-popup-header">
                  <h3>ÿßŸÑÿØÿπŸÖ ÿßŸÑŸÅŸÜŸä</h3>
                  <button class="close-popup" tabindex="0">√ó</button>
              </div>
              <div class="support-popup-content">
                  <form class="support-form" id="supportForm">
                      <div class="form-group">
                          <label class="form-label">ŸÖÿß ŸáŸä ŸÖÿ¥ŸÉŸÑÿ™ŸÉÿü</label>
                          <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 1rem;">Ÿäÿ±ÿ¨Ÿâ ŸàÿµŸÅ ÿßŸÑŸÖÿ¥ŸÉŸÑÿ© ÿßŸÑÿ™Ÿä ÿ™Ÿàÿßÿ¨ŸáŸáÿß</p>
                      </div>
                      
                      <div class="form-group">
                          <label class="form-label">ÿßÿ≥ŸÖ ÿßŸÑŸÇŸÜÿßÿ©</label>
                          <input type="text" class="form-input" id="channelNameInput" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÇŸÜÿßÿ©" maxlength="15" required>
                          <div class="char-counter" id="channelNameCounter">0/15</div>
                      </div>
                      
                      <div class="form-group">
                          <label class="form-label">ŸàÿµŸÅ ÿßŸÑŸÖÿ¥ŸÉŸÑÿ©</label>
                          <textarea class="form-input" id="problemDescription" rows="3" placeholder="ÿµŸÅ ÿßŸÑŸÖÿ¥ŸÉŸÑÿ© ÿ®ÿßŸÑÿ™ŸÅÿµŸäŸÑ" maxlength="25" required></textarea>
                          <div class="char-counter" id="problemDescriptionCounter">0/25</div>
                      </div>
                      
                      <button type="submit" class="submit-btn" id="submitSupportBtn">ÿ•ÿ±ÿ≥ÿßŸÑ</button>
                  </form>
              </div>
          </div>
      `;

      document.body.appendChild(popup);

      // Setup character counters
      const channelNameInput = document.getElementById('channelNameInput');
      const problemDescription = document.getElementById('problemDescription');
      const channelNameCounter = document.getElementById('channelNameCounter');
      const problemDescriptionCounter = document.getElementById('problemDescriptionCounter');

      channelNameInput.addEventListener('input', function() {
          channelNameCounter.textContent = `${this.value.length}/15`;
      });

      problemDescription.addEventListener('input', function() {
          problemDescriptionCounter.textContent = `${this.value.length}/25`;
      });

      // Check if user can submit (12 hours cooldown)
      const now = Date.now();
      const twelveHours = 12 * 60 * 60 * 1000;
      const submitBtn = document.getElementById('submitSupportBtn');
      
      if (now - lastSupportSubmit < twelveHours) {
          submitBtn.disabled = true;
          const remainingTime = twelveHours - (now - lastSupportSubmit);
          const hoursLeft = Math.ceil(remainingTime / (60 * 60 * 1000));
          submitBtn.textContent = `ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿ®ÿπÿØ ${hoursLeft} ÿ≥ÿßÿπÿ©`;
      }

      // Event listeners
      popup.querySelector('.close-popup').addEventListener('click', () => {
          document.body.removeChild(popup);
      });

      popup.querySelector('#supportForm').addEventListener('submit', handleSupportSubmit);

      popup.addEventListener('click', (e) => {
          if (e.target === popup) {
              document.body.removeChild(popup);
          }
      });

      // Focus on first input
      setTimeout(() => {
          channelNameInput.focus();
      }, 100);
  }

  function handleSupportSubmit(e) {
      e.preventDefault();
      
      const channelName = document.getElementById('channelNameInput').value.trim();
      const problemDescription = document.getElementById('problemDescription').value.trim();

      if (!channelName || !problemDescription) {
          showCustomAlert('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ');
          return;
      }

      // Save to Firebase
      const supportData = {
          channelName: channelName,
          problemDescription: problemDescription,
          timestamp: Date.now(),
          date: new Date().toLocaleString('ar-EG')
      };

      database.ref('supportTickets').push(supportData)
          .then(() => {
              // Update last submit time
              lastSupportSubmit = Date.now();
              localStorage.setItem('lastSupportSubmit', lastSupportSubmit);
              
              // Clear form and close popup
              document.getElementById('supportForm').reset();
              document.getElementById('channelNameCounter').textContent = '0/15';
              document.getElementById('problemDescriptionCounter').textContent = '0/25';
              
              // Close popup
              const popup = document.querySelector('.support-popup-overlay');
              if (popup) {
                  document.body.removeChild(popup);
              }
              
              showCustomAlert('ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ¥ŸÉŸàŸâ ÿ®ŸÜÿ¨ÿßÿ≠ÿå ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÉ!');
          })
          .catch((error) => {
              console.error('Error submitting support ticket:', error);
              showCustomAlert('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ');
          });
  }

  // Favorites - Using localStorage for persistent storage
  function saveFavorites() {
      try {
          localStorage.setItem('abdotv_favorites', JSON.stringify(favorites));
      } catch (error) {
          console.error('Error saving favorites:', error);
          // Fallback to session storage if localStorage fails
          try {
              sessionStorage.setItem('abdotv_favorites', JSON.stringify(favorites));
          } catch (e) {
              console.error('Error saving favorites to sessionStorage:', e);
          }
      }
  }

  function loadFavorites() {
      try {
          const stored = localStorage.getItem('abdotv_favorites');
          if (stored) {
              return JSON.parse(stored);
          }
      } catch (error) {
          console.error('Error loading favorites from localStorage:', error);
          // Fallback to session storage
          try {
              const sessionStored = sessionStorage.getItem('abdotv_favorites');
              if (sessionStored) {
                  return JSON.parse(sessionStored);
              }
          } catch (e) {
              console.error('Error loading favorites from sessionStorage:', e);
          }
      }
      return {};
  }

  function toggleFavorite(packageId, channelId, channelData) {
      if (!favorites[packageId]) favorites[packageId] = {};
      
      if (favorites[packageId][channelId]) {
          delete favorites[packageId][channelId];
          if (Object.keys(favorites[packageId]).length === 0) delete favorites[packageId];
      } else {
          favorites[packageId][channelId] = channelData;
      }
      
      saveFavorites();
      renderFavorites();
      
      // Update favorite button in channels section if it's currently open
      if (currentPackageId === packageId) {
          renderChannels();
      }
  }

  function isFavorite(packageId, channelId) {
      return favorites[packageId] && favorites[packageId][channelId];
  }

  function renderFavorites() {
      const grid = document.getElementById('favoritesGrid');
      if (!grid) return;

      grid.innerHTML = '';
      const hasFavorites = Object.keys(favorites).some(pkg => Object.keys(favorites[pkg]).length > 0);

      if (!hasFavorites) {
          grid.innerHTML = `
              <div class="empty-state">
                  <i class="fas fa-heart-broken"></i>
                  <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÇŸÜŸàÿßÿ™ ŸÖŸÅÿ∂ŸÑÿ©</h3>
                  <p>ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ≤ÿ± ÿßŸÑŸÇŸÑÿ® ŸÅŸä ÿ£Ÿä ŸÇŸÜÿßÿ© ŸÑÿ•ÿ∂ÿßŸÅÿ™Ÿáÿß ÿ•ŸÑŸâ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©</p>
              </div>
          `;
          return;
      }

      // ÿ¨ŸÖÿπ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÇŸÜŸàÿßÿ™ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ŸÅŸä ŸÖÿµŸÅŸàŸÅÿ© Ÿàÿßÿ≠ÿØÿ© Ÿàÿ™ÿ±ÿ™Ÿäÿ®Ÿáÿß ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®
      const allFavorites = [];
      Object.keys(favorites).forEach(packageId => {
          Object.keys(favorites[packageId]).forEach(channelId => {
              const channel = favorites[packageId][channelId];
              allFavorites.push({
                  packageId,
                  channelId,
                  channel,
                  order: channel.order || 0
              });
          });
      });

      // ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑŸÇŸÜŸàÿßÿ™ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®
      allFavorites.sort((a, b) => a.order - b.order);

      allFavorites.forEach(fav => {
          const card = document.createElement('div');
          card.className = 'card channel-card ripple';
          card.setAttribute('tabindex', '0');

          const iconHtml = fav.channel.image
              ? `<img src="${fav.channel.image}" class="channel-icon" alt="${fav.channel.name}">`
              : `<div class="channel-icon-placeholder" style="color: ${fav.channel.color || '#9D4EDD'};"><i class="fas fa-tv"></i></div>`;

          card.innerHTML = `
              ${iconHtml}
              <div class="channel-info">
                  <h3 class="channel-name">${fav.channel.name}</h3>
              </div>
              <button class="favorite-btn active" onclick="event.stopPropagation(); toggleFavorite('${fav.packageId}', '${fav.channelId}', null)" tabindex="0">
                  <i class="fas fa-heart"></i>
              </button>
          `;

          card.onclick = (e) => {
              if (!e.target.closest('.favorite-btn')) {
                  // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÜŸàÿπ ÿßŸÑŸÇŸÜÿßÿ© ŸàŸÅÿ™ÿ≠ ÿßŸÑÿ®ÿ´ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ£Ÿà ÿπÿ±ÿ∂ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
                  if (fav.channel.serverType === 'single') {
                      openChannelDirectly(fav.channel);
                  } else {
                      showServerPopup(fav.channel);
                  }
              }
          };

          addPressEffect(card);
          grid.appendChild(card);
      });
  }

  // Ÿàÿ∏ŸäŸÅÿ© ŸÅÿ™ÿ≠ ÿßŸÑŸÇŸÜÿßÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ®ÿØŸàŸÜ ŸÜÿßŸÅÿ∞ÿ©
  function openChannelDirectly(channelData) {
      const servers = channelData.servers || {};
      const url = servers.url;
      
      if (url && url.startsWith('go:')) {
          window.location.href = url;
      } else {
          showCustomAlert('ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ®ÿ´ ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ ÿ≠ÿßŸÑŸäÿßŸã');
      }
  }

  function getArabicDayName() {
      const days = ['ÿßŸÑÿ£ÿ≠ÿØ', 'ÿßŸÑÿßÿ´ŸÜŸäŸÜ', 'ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°', 'ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°', 'ÿßŸÑÿÆŸÖŸäÿ≥', 'ÿßŸÑÿ¨ŸÖÿπÿ©', 'ÿßŸÑÿ≥ÿ®ÿ™'];
      return days[new Date().getDay()];
  }

  function updateMatchesSectionTitle() {
      const title = document.getElementById('matchesSectionTitle');
      if (title) title.textContent = `ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸäŸàŸÖ ${getArabicDayName()}`;
  }

  // App Status Check
  async function checkAppStatus() {
      return new Promise((resolve) => {
          database.ref('appStatus').once('value', (snapshot) => {
              const status = snapshot.val() || {};

              if (status.maintenance && status.maintenance.enabled) {
                  document.getElementById('maintenancePage').classList.add('active');
                  document.getElementById('loadingScreen').classList.add('hidden');
                  if (status.maintenance.estimatedTime) {
                      document.getElementById('maintenanceTimeDisplay').textContent = status.maintenance.estimatedTime;
                  }
                  if (status.maintenance.message) {
                      document.getElementById('maintenanceMessageDisplay').textContent = status.maintenance.message;
                  }
                  resolve(false);
              } else if (status.update && status.update.enabled) {
                  document.getElementById('updatePage').classList.add('active');
                  document.getElementById('loadingScreen').classList.add('hidden');
                  const updateData = status.update;
                  if (updateData.version) {
                      document.getElementById('updateVersionDisplay').textContent = `ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿ¨ÿØŸäÿØ: ${updateData.version}`;
                  }
                  if (updateData.description) {
                      document.getElementById('updateDescriptionDisplay').textContent = updateData.description;
                      document.getElementById('updateFeaturesDisplay').textContent = updateData.description;
                  }
                  if (updateData.downloadUrl) {
                      const downloadLink = document.getElementById('downloadLink');
                      downloadLink.href = updateData.downloadUrl;
                      downloadLink.target = '_blank';
                  }
                  resolve(false);
              } else {
                  resolve(true);
              }
          });
      });
  }

  function listenToAppStatusChanges() {
      database.ref('appStatus').on('value', (snapshot) => {
          const status = snapshot.val() || {};

          if (status.maintenance && status.maintenance.enabled) {
              document.getElementById('maintenancePage').classList.add('active');
              if (status.maintenance.estimatedTime) {
                  document.getElementById('maintenanceTimeDisplay').textContent = status.maintenance.estimatedTime;
              }
              if (status.maintenance.message) {
                  document.getElementById('maintenanceMessageDisplay').textContent = status.maintenance.message;
              }
          } else {
              document.getElementById('maintenancePage').classList.remove('active');
          }

          if (status.update && status.update.enabled) {
              document.getElementById('updatePage').classList.add('active');
              const updateData = status.update;
              if (updateData.version) {
                  document.getElementById('updateVersionDisplay').textContent = `ÿßŸÑÿ•ÿµÿØÿßÿ± ÿßŸÑÿ¨ÿØŸäÿØ: ${updateData.version}`;
              }
              if (updateData.description) {
                  document.getElementById('updateDescriptionDisplay').textContent = updateData.description;
                  document.getElementById('updateFeaturesDisplay').textContent = updateData.description;
              }
              if (updateData.downloadUrl) {
                  const downloadLink = document.getElementById('downloadLink');
                  downloadLink.href = updateData.downloadUrl;
                  downloadLink.target = '_blank';
              }
          } else {
              document.getElementById('updatePage').classList.remove('active');
          }
      });
  }

  // Load Data
  async function loadAllData() {
      const canLoad = await checkAppStatus();
      if (!canLoad) return;

      try {
          await Promise.all([loadPackages(), loadChannels(), loadMatches(), loadMatchResults()]);
          updateMatchesSectionTitle();
          renderFavorites();
          setTimeout(() => document.getElementById('loadingScreen').classList.add('hidden'), 1000);
      } catch (error) {
          console.error('Error loading data:', error);
          document.getElementById('loadingScreen').classList.add('hidden');
      }
  }

  function loadPackages() {
      return new Promise((resolve) => {
          database.ref('packages').on('value', (snapshot) => {
              packages = snapshot.val() || {};
              renderPackages();
              renderFeaturedPackages();
              resolve();
          });
      });
  }

  function loadChannels() {
      return new Promise((resolve) => {
          database.ref('channels').on('value', (snapshot) => {
              channels = snapshot.val() || {};
              resolve();
          });
      });
  }

  function loadMatches() {
      return new Promise((resolve) => {
          database.ref('matches').on('value', (snapshot) => {
              matches = snapshot.val() || {};
              renderMatches();
              resolve();
          });
      });
  }

  function loadMatchResults() {
      return new Promise((resolve) => {
          database.ref('matchResults').on('value', (snapshot) => {
              matchResults = snapshot.val() || {};
              renderMatches();
              resolve();
          });
      });
  }

  function addPressEffect(card) {
      card.addEventListener('click', function() {
          this.classList.add('pressed');
          setTimeout(() => this.classList.remove('pressed'), 400);
      });
  }

  function renderPackages() {
      const grid = document.getElementById('featuredPackages');
      if (!grid) return;
      grid.innerHTML = '';

      if (Object.keys(packages).length === 0) {
          grid.innerHTML = `
              <div class="empty-state">
                  <i class="fas fa-box"></i>
                  <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ÿßŸÇÿßÿ™ ÿ≠ÿßŸÑŸäÿßŸã</h3>
                  <p>ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ£Ÿä ÿ®ÿßŸÇÿßÿ™ ÿ®ÿπÿØ</p>
              </div>
          `;
          return;
      }

      // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ÿßŸÇÿßÿ™ ÿ•ŸÑŸâ ŸÖÿµŸÅŸàŸÅÿ© Ÿàÿ™ÿ±ÿ™Ÿäÿ®Ÿáÿß ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ŸÇŸÑ order
      const sortedPackages = Object.entries(packages)
          .map(([key, pkg]) => ({ key, ...pkg }))
          .sort((a, b) => (a.order || 0) - (b.order || 0));

      sortedPackages.forEach(pkg => {
          const card = document.createElement('div');
          card.className = 'card package-card ripple';
          card.style.background = `linear-gradient(135deg, ${pkg.color}15, ${pkg.color}25)`;
          card.onclick = () => openPackageChannels(pkg.key, pkg.name);
          card.setAttribute('tabindex', '0');

          const iconHtml = pkg.image
              ? `<img src="${pkg.image}" class="package-icon" alt="${pkg.name}">`
              : `<div class="package-icon-placeholder" style="color: ${pkg.color};"><i class="fas fa-box"></i></div>`;

          card.innerHTML = `
              ${iconHtml}
              <div class="package-info">
                  <h3 class="package-name">${pkg.name}</h3>
                  ${pkg.description ? `<p class="package-desc">${pkg.description}</p>` : ''}
              </div>
              <div class="package-arrow">
                  <i class="fas fa-chevron-left"></i>
              </div>
          `;
          addPressEffect(card);
          grid.appendChild(card);
      });
  }

  function renderFeaturedPackages() {
      renderPackages();
  }

  function openPackageChannels(packageId, packageName) {
      currentPackageId = packageId;
      currentPackageName = packageName;
      document.getElementById('channelsSectionTitle').textContent = packageName;
      showSection('channels');
      renderChannels();
      hideBottomNav();
  }

  function renderChannels() {
      const grid = document.getElementById('channelsGrid');
      grid.innerHTML = '';

      if (!currentPackageId || !channels[currentPackageId]) {
          grid.innerHTML = `
              <div class="empty-state">
                  <i class="fas fa-tv"></i>
                  <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÇŸÜŸàÿßÿ™</h3>
                  <p>ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ŸÇŸÜŸàÿßÿ™ ŸÑŸáÿ∞Ÿá ÿßŸÑÿ®ÿßŸÇÿ© ÿ®ÿπÿØ</p>
              </div>
          `;
          return;
      }

      const packageChannels = channels[currentPackageId];
      
      // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑŸÇŸÜŸàÿßÿ™ ÿ•ŸÑŸâ ŸÖÿµŸÅŸàŸÅÿ© Ÿàÿ™ÿ±ÿ™Ÿäÿ®Ÿáÿß ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ŸÇŸÑ order
      const sortedChannels = Object.entries(packageChannels)
          .map(([key, channel]) => ({ key, ...channel }))
          .sort((a, b) => (a.order || 0) - (b.order || 0));

      sortedChannels.forEach(channel => {
          const card = document.createElement('div');
          card.className = 'card channel-card ripple';
          card.setAttribute('tabindex', '0');

          const iconHtml = channel.image
              ? `<img src="${channel.image}" class="channel-icon" alt="${channel.name}">`
              : `<div class="channel-icon-placeholder" style="color: ${channel.color || '#9D4EDD'};"><i class="fas fa-tv"></i></div>`;

          const isFav = isFavorite(currentPackageId, channel.key);

          card.innerHTML = `
              ${iconHtml}
              <div class="channel-info">
                  <h3 class="channel-name">${channel.name}</h3>
              </div>
              <button class="favorite-btn ${isFav ? 'active' : ''}" onclick="event.stopPropagation(); toggleFavorite('${currentPackageId}', '${channel.key}', ${JSON.stringify(channel).replace(/"/g, '&quot;')})" tabindex="0">
                  <i class="fas fa-heart"></i>
              </button>
          `;

          card.onclick = (e) => {
              if (!e.target.closest('.favorite-btn')) {
                  // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÜŸàÿπ ÿßŸÑŸÇŸÜÿßÿ© ŸàŸÅÿ™ÿ≠ ÿßŸÑÿ®ÿ´ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ£Ÿà ÿπÿ±ÿ∂ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
                  if (channel.serverType === 'single') {
                      openChannelDirectly(channel);
                  } else {
                      showServerPopup(channel);
                  }
              }
          };

          addPressEffect(card);
          grid.appendChild(card);
      });
  }

  // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸàŸÇŸäÿ™ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä
  function parseMatchTime(timeString) {
      if (!timeString) return null;

      try {
          const [period, time] = timeString.split(' ');
          const [hours, minutes] = time.split(':');

          let hour = parseInt(hours);
          const minute = parseInt(minutes);

          if (period === 'PM' && hour !== 12) {
              hour += 12;
          } else if (period === 'AM' && hour === 12) {
              hour = 0;
          }

          const matchTime = new Date();
          matchTime.setHours(hour, minute, 0, 0);

          return matchTime;
      } catch (error) {
          console.error('Error parsing match time:', error);
          return null;
      }
  }

  function getMatchStatus(match, matchId) {
      const now = new Date();
      const matchTime = parseMatchTime(match.time);
      const result = matchResults[matchId] || { score1: 0, score2: 0 };
      const isEnded = match.isEnded || false;

      if (isEnded) {
          return {
              timeHtml: `<div class="match-time ended">ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ©</div>`,
              scoreHtml: `<div class="live-score">${result.score1} - ${result.score2}</div>`
          };
      }

      if (match.isLive) {
          return {
              timeHtml: `<div class="match-time live">ÿ¨ÿßÿ±Ÿäÿ© ÿßŸÑÿ¢ŸÜ</div>`,
              scoreHtml: `<div class="live-score">${result.score1} - ${result.score2}</div>`
          };
      }

      if (matchTime && now >= matchTime && !match.isEnded) {
          return {
              timeHtml: `<div class="match-time live">ÿ¨ÿßÿ±Ÿäÿ© ÿßŸÑÿ¢ŸÜ</div>`,
              scoreHtml: `<div class="live-score">${result.score1} - ${result.score2}</div>`
          };
      }

      return {
          timeHtml: `<div class="match-time">${match.time}</div>`,
          scoreHtml: `<div class="default-score">0 - 0</div>`
      };
  }

  function checkAndUpdateMatchStatus() {
      const now = new Date();
      let needsUpdate = false;

      Object.keys(matches).forEach(matchId => {
          const match = matches[matchId];
          if (!match.isLive && !match.isEnded) {
              const matchTime = parseMatchTime(match.time);
              if (matchTime && now >= matchTime) {
                  database.ref('matches/' + matchId).update({
                      isLive: true
                  });
                  needsUpdate = true;
              }
          }
      });

      if (needsUpdate) {
          renderMatches();
      }
  }

  function renderMatches() {
      const grid = document.getElementById('matchesGrid');
      if (!grid) return;

      grid.innerHTML = '';
      Object.values(matchTimers).forEach(timer => clearInterval(timer));
      matchTimers = {};

      if (Object.keys(matches).length === 0) {
          grid.innerHTML = `
              <div class="empty-state">
                  <i class="fas fa-futbol"></i>
                  <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™</h3>
                  <p>ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ£Ÿä ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿ®ÿπÿØ</p>
              </div>
          `;
          return;
      }

      // ŸÅÿ±ÿ≤ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™: ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑÿ¨ÿßÿ±Ÿäÿ© ÿ£ŸàŸÑÿßŸãÿå ÿ´ŸÖ ÿßŸÑŸÇÿßÿØŸÖÿ©ÿå ÿ´ŸÖ ÿßŸÑŸÖŸÜÿ™ŸáŸäÿ©
      const sortedMatches = Object.entries(matches).sort(([idA, matchA], [idB, matchB]) => {
          // ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑÿ¨ÿßÿ±Ÿäÿ© ÿ£ŸàŸÑÿßŸã
          if (matchA.isLive && !matchB.isLive) return -1;
          if (!matchA.isLive && matchB.isLive) return 1;

          // ÿ´ŸÖ ÿßŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑŸÇÿßÿØŸÖÿ©
          if (!matchA.isEnded && matchB.isEnded) return -1;
          if (matchA.isEnded && !matchB.isEnded) return 1;

          return 0;
      });

      sortedMatches.forEach(([key, match]) => {
          const card = document.createElement('div');
          card.className = 'card match-card ripple';
          card.setAttribute('tabindex', '0');

          // ÿ•ÿ∂ÿßŸÅÿ© ÿÆÿßÿµŸäÿ© ÿßŸÑŸÜŸÇÿ± ŸÑŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ Ÿàÿ≥ŸàŸÖ
          if (match.servers && Object.keys(match.servers).some(server => match.servers[server])) {
              card.onclick = () => showServerPopup(match);
          }

          const team1Logo = match.team1Logo ?
    `<div class="team-logo">
        <img src="${match.team1Logo}" alt="${match.team1Name}" onerror="this.parentElement.innerHTML='‚öΩ'">
     </div>` :
    `<div class="team-logo">‚öΩ</div>`;

const team2Logo = match.team2Logo ?
    `<div class="team-logo">
        <img src="${match.team2Logo}" alt="${match.team2Name}" onerror="this.parentElement.innerHTML='‚öΩ'">
     </div>` :
    `<div class="team-logo">‚öΩ</div>`;

          const matchStatus = getMatchStatus(match, key);

          card.innerHTML = `
    ${match.isLive ? `
        <div class="live-badge">
            <div class="live-dot"></div>
            ŸÖÿ®ÿßÿ¥ÿ±
        </div>
    ` : ''}
    <div class="match-header">
        <div class="match-league">${match.league}</div>
    </div>
    <div class="match-teams">
        <div class="team">
            ${team1Logo}
            <div class="team-name">${match.team1Name}</div>
        </div>

        <div class="match-time-container">
            ${matchStatus.timeHtml}
            ${matchStatus.scoreHtml}
        </div>

        <div class="team">
            ${team2Logo}
            <div class="team-name">${match.team2Name}</div>
        </div>
    </div>
    <div class="match-info">
        ${match.commentator ? `
            <div class="match-commentator">
                <i class="fas fa-microphone"></i>
                ${match.commentator}
            </div>
        ` : '<div></div>'}
        <div class="match-channel">
            <i class="fas fa-tv"></i>
            ${match.channel || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}
        </div>
    </div>
`;

          // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ∂ÿ∫ÿ∑ ŸÅŸÇÿ∑ ŸÑŸÑŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ™ŸàŸä ÿπŸÑŸâ Ÿàÿ≥ŸàŸÖ
          if (match.servers && Object.keys(match.servers).some(server => match.servers[server])) {
              addPressEffect(card);
          }
          grid.appendChild(card);
      });

      matchTimers['statusCheck'] = setInterval(checkAndUpdateMatchStatus, 30000);
  }

  // ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±ÿßÿ™ ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜ ŸÖÿπ ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿµÿ≠Ÿäÿ≠
  function showServerPopup(streamData) {
      const servers = streamData.servers || {};

      // ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑÿ∑ŸÑÿ®: ÿßÿ≥ÿßÿ≥Ÿäÿå HDÿå SDÿå LOWÿå ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä 1
      const serverOrder = ['url', 'hd', 'sd', 'low', 'backup1', 'fhd'];

      const availableServers = serverOrder
          .filter(key => servers[key] && servers[key].trim() !== '')
          .map(key => ({
              key,
              url: servers[key],
              label: getServerLabel(key),
              quality: getServerQualityHint(key)
          }));

      if (availableServers.length === 0) {
          showCustomAlert('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ≥Ÿäÿ±ŸÅÿ±ÿßÿ™ ŸÖÿ™ÿßÿ≠ÿ© ÿ≠ÿßŸÑŸäŸãÿß');
          return;
      }

      // ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
      const popup = document.createElement('div');
      popup.className = 'server-popup-overlay';
      popup.innerHTML = `
          <div class="server-popup">
              <div class="server-popup-header">
                  <h3>${streamData.name || streamData.team1Name + ' vs ' + streamData.team2Name || 'ÿßÿÆÿ™ÿ± ÿ≥Ÿäÿ±ŸÅÿ± ÿßŸÑÿ®ÿ´'}</h3>
                  <button class="close-popup" tabindex="0">√ó</button>
              </div>
              <div class="server-popup-content">
                  ${availableServers.map((server, index) => `
                      <div class="server-option" data-url="${server.url}" tabindex="0">
                          <div class="server-info">
                              <span class="server-label">${server.label}</span>
                              ${server.quality ? `<span class="server-quality-hint">${server.quality}</span>` : ''}
                          </div>
                          <div class="open-indicator">
                              <i class="fas fa-play"></i>
                          </div>
                      </div>
                  `).join('')}
              </div>
          </div>
      `;

      document.body.appendChild(popup);

      // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
      popup.querySelector('.close-popup').addEventListener('click', () => {
          document.body.removeChild(popup);
      });

      popup.querySelectorAll('.server-option').forEach(option => {
          option.addEventListener('click', (e) => {
              e.stopPropagation();
              const url = option.getAttribute('data-url');

              if (url && url.startsWith('go:')) {
                  // ŸÅÿ™ÿ≠ ÿßŸÑÿ±ÿßÿ®ÿ∑ ŸÖÿ®ÿßÿ¥ÿ±ÿ©
                  window.location.href = url;

                  // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
                  setTimeout(() => {
                      if (popup.parentElement) {
                          document.body.removeChild(popup);
                      }
                  }, 500);
              } else {
                  showCustomAlert('ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠');
              }
          });

          // ÿØÿπŸÖ Enter ŸÑŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿ±ŸäŸÖŸàÿ™
          option.addEventListener('keypress', (e) => {
              if (e.key === 'Enter') {
                  option.click();
              }
          });
      });

      // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
      popup.addEventListener('click', (e) => {
          if (e.target === popup) {
              document.body.removeChild(popup);
          }
      });

      // ÿØÿπŸÖ Escape ŸÑŸÑÿ•ÿ∫ŸÑÿßŸÇ
      const escapeHandler = (e) => {
          if (e.key === 'Escape' && popup.parentElement) {
              document.body.removeChild(popup);
              document.removeEventListener('keydown', escapeHandler);
          }
      };
      document.addEventListener('keydown', escapeHandler);

      // ÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿ£ŸàŸÑ ÿ≥Ÿäÿ±ŸÅÿ±
      setTimeout(() => {
          const firstServer = popup.querySelector('.server-option');
          if (firstServer) firstServer.focus();
      }, 100);
  }

  function getServerLabel(key) {
      const labels = {
          url: 'FHD',
          hd: 'HD',
          sd: 'SD',
          low: 'LOW',
          backup1: 'ŸÖÿ™ÿπÿØÿØ',
          fhd: 'FHD'
      };
      return labels[key] || key;
  }

  function getServerQualityHint(key) {
      const hints = {
          url: 'ÿßŸÑÿ¨ŸàÿØÿ© ÿßŸÑÿ£ŸÅÿ∂ŸÑ',
          hd: 'ÿ¨ŸàÿØÿ© ÿπÿßŸÑŸäÿ©',
          sd: 'ÿ¨ŸàÿØÿ© ŸÖÿ™Ÿàÿ≥ÿ∑ÿ©',
          low: 'ÿ¨ŸàÿØÿ© ŸÖŸÜÿÆŸÅÿ∂ÿ©',
          backup1: 'ÿ¨ŸàÿØÿ© ÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©',
          fhd: 'ÿ¨ŸàÿØÿ© ŸÅÿßÿ¶ŸÇÿ©'
      };
      return hints[key] || '';
  }

  // Custom Alert Function
  function showCustomAlert(message) {
      const alertDiv = document.createElement('div');
      alertDiv.className = 'server-popup-overlay';
      alertDiv.innerHTML = `
          <div class="server-popup" style="max-width: 350px;">
              <div class="server-popup-header">
                  <h3>ÿ™ŸÜÿ®ŸäŸá</h3>
                  <button class="close-popup" tabindex="0">√ó</button>
              </div>
              <div class="server-popup-content">
                  <p style="text-align: center; padding: 1rem; font-size: 1.1rem; color: var(--text-primary);">${message}</p>
              </div>
          </div>
      `;

      document.body.appendChild(alertDiv);

      const closeBtn = alertDiv.querySelector('.close-popup');
      closeBtn.addEventListener('click', () => {
          document.body.removeChild(alertDiv);
      });

      alertDiv.addEventListener('click', (e) => {
          if (e.target === alertDiv) {
              document.body.removeChild(alertDiv);
          }
      });
  }

  // UI Functions
  function updateHeaderUI(section) {
      const backBtn = document.getElementById('backBtnHeader');
      const menuBtn = document.getElementById('menuBtn');
      const supportBtn = document.getElementById('supportBtn');
      const headerLogo = document.getElementById('headerLogo');
      const headerTitle = document.getElementById('headerTitle');

      if (section === 'channels') {
          backBtn.classList.add('active');
          menuBtn.classList.add('hidden');
          supportBtn.classList.add('active');
          headerLogo.classList.add('hidden');
          headerTitle.classList.add('active');
          headerTitle.textContent = currentPackageName || 'ÿßŸÑŸÇŸÜŸàÿßÿ™';
      } else {
          backBtn.classList.remove('active');
          menuBtn.classList.remove('hidden');
          supportBtn.classList.remove('active');
          headerLogo.classList.remove('hidden');
          headerTitle.classList.remove('active');
      }
  }

  function hideBottomNav() {
      document.getElementById('bottomNav').classList.add('hidden');
  }

  function showBottomNav() {
      document.getElementById('bottomNav').classList.remove('hidden');
  }

  function showSection(sectionName) {
      document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
      document.getElementById(sectionName + 'Section').classList.add('active');

      if (sectionName !== 'search') {
          document.querySelectorAll('.nav-tab').forEach(tab => {
              tab.classList.remove('active');
              if (tab.getAttribute('data-section') === sectionName) tab.classList.add('active');
          });
      }

      if (sectionName === 'search') {
          document.querySelector('.header').style.display = 'none';
          document.querySelector('.moving-text-container').style.display = 'none';
      } else {
          document.querySelector('.header').style.display = 'block';
          document.querySelector('.moving-text-container').style.display = 'flex';
      }

      const headerContent = document.querySelector('.header-content');
      if (['channels', 'matches', 'favorites'].includes(sectionName)) {
          headerContent.classList.add('hide-search');
      } else {
          headerContent.classList.remove('hide-search');
      }

      // Hide moving text in non-home sections
      const movingTextContainer = document.getElementById('movingTextContainer');
      if (sectionName === 'home') {
          movingTextContainer.style.display = 'flex';
      } else {
          movingTextContainer.style.display = 'none';
      }

      updateHeaderUI(sectionName);

      if (['home', 'matches', 'favorites'].includes(sectionName)) showBottomNav();
      else hideBottomNav();

      window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // Event Listeners
  const menuBtn = document.getElementById('menuBtn');
  const sideMenu = document.getElementById('sideMenu');
  const sideMenuOverlay = document.getElementById('sideMenuOverlay');
  const supportBtn = document.getElementById('supportBtn');

  menuBtn.addEventListener('click', () => {
      sideMenu.classList.add('active');
      sideMenuOverlay.classList.add('active');
  });

  sideMenuOverlay.addEventListener('click', () => {
      sideMenu.classList.remove('active');
      sideMenuOverlay.classList.remove('active');
  });

  supportBtn.addEventListener('click', () => {
      showSupportPopup();
  });

  document.getElementById('backBtnHeader').addEventListener('click', () => {
      showSection('home');
      showBottomNav();
  });

  document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
          const section = tab.getAttribute('data-section');
          showSection(section);
      });
  });

  document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
          if (sideMenu.classList.contains('active')) {
              sideMenu.classList.remove('active');
              sideMenuOverlay.classList.remove('active');
          }
      }
  });

  // Search Functions
  function setupSearchPage() {
      const searchBtn = document.getElementById('searchBtn');
      const searchPageInput = document.getElementById('searchPageInput');

      searchBtn.addEventListener('click', () => showSearchPage());

      searchPageInput.addEventListener('input', (e) => performPageSearch(e.target.value));

      searchPageInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') performPageSearch(e.target.value);
      });
  }

  function showSearchPage() {
      document.querySelector('.header').style.display = 'none';
      document.querySelector('.moving-text-container').style.display = 'none';
      showSection('search');
      hideBottomNav();
      const searchInput = document.getElementById('searchPageInput');
      searchInput.value = '';
      searchInput.focus();
      document.getElementById('searchPageResults').innerHTML = '';
  }

  function goBackFromSearch() {
      document.querySelector('.header').style.display = 'block';
      document.querySelector('.moving-text-container').style.display = 'flex';
      showSection('home');
  }

  function performPageSearch(query) {
      const searchResults = document.getElementById('searchPageResults');

      if (!query.trim()) {
          searchResults.innerHTML = `
              <div class="search-page-no-results">
                  <i class="fas fa-search"></i>
                  <h3>ÿßÿ®ÿØÿ£ ÿ®ÿßŸÑŸÉÿ™ÿßÿ®ÿ© ŸÑŸÑÿ®ÿ≠ÿ´</h3>
                  <p>ÿßŸÉÿ™ÿ® ÿßÿ≥ŸÖ ÿßŸÑŸÇŸÜÿßÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ±ŸäÿØ ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜŸáÿß</p>
              </div>
          `;
          return;
      }

      const results = searchAllChannels(query.toLowerCase());
      displayPageSearchResults(results);
  }

  function searchAllChannels(query) {
      const results = [];

      Object.keys(channels).forEach(packageId => {
          const packageChannels = channels[packageId];
          const packageName = packages[packageId]?.name || 'ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ';

          // ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑŸÇŸÜŸàÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ® ŸÇÿ®ŸÑ ÿßŸÑÿ®ÿ≠ÿ´
          const sortedChannels = Object.entries(packageChannels)
              .map(([channelId, channel]) => ({ channelId, ...channel }))
              .sort((a, b) => (a.order || 0) - (b.order || 0));

          sortedChannels.forEach(channel => {
              if (channel.name.toLowerCase().includes(query)) {
                  results.push({ channel, packageId, packageName, channelId: channel.channelId });
              }
          });
      });

      return results.sort((a, b) => a.channel.name.localeCompare(b.channel.name));
  }

  function displayPageSearchResults(results) {
      const searchResults = document.getElementById('searchPageResults');

      if (results.length === 0) {
          searchResults.innerHTML = `
              <div class="search-page-no-results">
                  <i class="fas fa-times-circle"></i>
                  <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨</h3>
                  <p>ŸÑŸÖ ŸÜÿπÿ´ÿ± ÿπŸÑŸâ ŸÇŸÜŸàÿßÿ™ ÿ™ÿ∑ÿßÿ®ŸÇ ÿ®ÿ≠ÿ´ŸÉ</p>
              </div>
          `;
          return;
      }

      searchResults.innerHTML = results.map(result => {
          const iconHtml = result.channel.image
              ? `<img src="${result.channel.image}" class="channel-icon" alt="${result.channel.name}">`
              : `<div class="channel-icon-placeholder" style="color: ${result.channel.color || '#9D4EDD'}; width: 55px; height: 55px; border-radius: 12px; display: flex; align-items: center; justify-content: center; background: rgba(157, 78, 221, 0.1);">
                   <i class="fas fa-tv"></i>
                 </div>`;

          return `
              <div class="search-page-result-item ripple" onclick="handleSearchResultClick(${JSON.stringify(result.channel).replace(/"/g, '&quot;')})" tabindex="0">
                  ${iconHtml}
                  <div class="channel-info">
                      <div class="channel-name">${result.channel.name}</div>
                      <div class="package-name">${result.packageName}</div>
                  </div>
              </div>
          `;
      }).join('');
  }

  // Ÿàÿ∏ŸäŸÅÿ© ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ŸÜŸÇÿ± ŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑÿ®ÿ≠ÿ´
  function handleSearchResultClick(channelData) {
      if (channelData.serverType === 'single') {
          openChannelDirectly(channelData);
      } else {
          showServerPopup(channelData);
      }
  }

  // Moving Text from Firebase
  document.addEventListener("DOMContentLoaded", function() {
      const movingText = document.getElementById("movingText");
      database.ref("headerText").on("value", snapshot => {
          const text = snapshot.val();
          if (movingText && text) movingText.textContent = text;
      });

      setTimeout(setupSearchPage, 1000);
  });

  // Initialize App
  async function initializeApp() {
    await checkAppStatus();
    if (!document.getElementById('maintenancePage').classList.contains('active') &&
        !document.getElementById('updatePage').classList.contains('active')) {
        await loadAllData();
    }
    listenToAppStatusChanges();

    // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ÿπŸÜÿØ ÿßŸÑÿ®ÿØÿ°
    favorites = loadFavorites();
    renderFavorites();
  }

  // ÿ¨ÿπŸÑ ÿßŸÑÿØŸàÿßŸÑ ŸÖÿ™ÿßÿ≠ÿ© ÿπÿßŸÑŸÖŸäÿßŸã
  window.showSupportPopup = showSupportPopup;
  window.handleSupportSubmit = handleSupportSubmit;
  window.openChannelDirectly = openChannelDirectly;
  window.showServerPopup = showServerPopup;
  window.showCustomAlert = showCustomAlert;
  window.toggleFavorite = toggleFavorite;
  window.goBackFromSearch = goBackFromSearch;
  window.handleSearchResultClick = handleSearchResultClick;

  initializeApp();
</script>
</body>
</html>
