<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yacine TV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        * {
            font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #764BA2 0%, #667EEA 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #764BA2 0%, #667EEA 100%);
        }

        .channel-button {
            background: white;
            border: 3px solid #764BA2;
            border-radius: 12px;
            padding: 20px;
            margin: 10px;
            font-size: 18px;
            font-weight: bold;
            color: #764BA2;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .channel-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(118, 75, 162, 0.3);
        }

        .channel-card {
            background: white;
            border: 3px solid #764BA2;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 140px;
        }

        .channel-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(118, 75, 162, 0.4);
        }

        .channel-logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }

        .channel-name {
            color: #666;
            font-size: 14px;
            text-align: center;
            font-weight: 600;
        }

        .match-card {
            background: white;
            border: 3px solid #764BA2;
            border-radius: 12px;
            padding: 20px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(118, 75, 162, 0.3);
        }

        .team-logo {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }

        .status-badge {
            background: #e5e7eb;
            color: #666;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .bottom-nav {
            background: #764BA2;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .nav-button {
            color: rgba(255,255,255,0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: none;
            border: none;
        }

        .nav-button.active {
            color: white;
        }

        .nav-button i {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header {
            background: #764BA2;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-title {
            font-size: 20px;
            font-weight: bold;
        }

        .icon-button {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .content-container {
            padding: 15px;
            padding-bottom: 80px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        @media (max-width: 768px) {
            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .hidden {
            display: none;
        }

        .back-button {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
        }

        .loading {
            text-align: center;
            color: white;
            padding: 40px;
            font-size: 18px;
        }

        .match-info {
            display: flex;
            align-items: center;
            color: #666;
            font-size: 13px;
            margin-top: 8px;
        }

        .match-info i {
            margin-left: 8px;
            color: #764BA2;
        }
    </style>
</head>
<body>
    <!-- الصفحة الرئيسية -->
    <div id="homePage">
        <div class="header">
            <button class="icon-button" onclick="toggleMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <div class="header-title">Yacine TV</div>
            <button class="icon-button" onclick="searchChannels()">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <div class="content-container" id="homeContent">
            <div class="loading">جاري تحميل القنوات...</div>
        </div>

        <div class="bottom-nav">
            <button class="nav-button active" onclick="showPage('home')">
                <i class="fas fa-tv"></i>
                <span>LIVE TV</span>
            </button>
            <button class="nav-button" onclick="showPage('events')">
                <i class="far fa-calendar"></i>
                <span>LIVE EVENT</span>
            </button>
        </div>
    </div>

    <!-- صفحة القنوات الفرعية -->
    <div id="channelsPage" class="hidden">
        <div class="header">
            <button class="back-button" onclick="backToHome()">
                <i class="fas fa-arrow-right"></i>
            </button>
            <div class="header-title" id="channelsTitle"></div>
            <button class="icon-button" onclick="searchChannels()">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <div class="content-container grid-3" id="channelsContent">
            <div class="loading">جاري تحميل القنوات...</div>
        </div>
    </div>

    <!-- صفحة المباريات -->
    <div id="eventsPage" class="hidden">
        <div class="header">
            <button class="back-button" onclick="backToHome()">
                <i class="fas fa-arrow-right"></i>
            </button>
            <div class="header-title">LIVE EVENT</div>
            <button class="icon-button" onclick="searchChannels()">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <div class="content-container" id="eventsContent">
            <div class="loading">جاري تحميل المباريات...</div>
        </div>

        <div class="bottom-nav">
            <button class="nav-button" onclick="showPage('home')">
                <i class="fas fa-tv"></i>
                <span>LIVE TV</span>
            </button>
            <button class="nav-button active" onclick="showPage('events')">
                <i class="far fa-calendar"></i>
                <span>LIVE EVENT</span>
            </button>
        </div>
    </div>

    <script>
        // تهيئة Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyC9ZTWHYrctKe0MVWLoKVYJZJjBd0-Kfz8",
            authDomain: "nmih-5c9d7.firebaseapp.com",
            databaseURL: "https://nmih-5c9d7-default-rtdb.firebaseio.com",
            projectId: "nmih-5c9d7",
            storageBucket: "nmih-5c9d7.firebasestorage.app",
            messagingSenderId: "1045208701183",
            appId: "1:1045208701183:android:d207abe6916231388154ca"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let currentCategory = null;

        // تحميل الباقات من Firebase
        function loadPackages() {
            const homeContent = document.getElementById('homeContent');
            homeContent.innerHTML = '<div class="loading">جاري تحميل القنوات...</div>';

            database.ref('packages').on('value', (snapshot) => {
                const packages = snapshot.val();
                homeContent.innerHTML = '';

                if (packages) {
                    Object.keys(packages).forEach(key => {
                        const pkg = packages[key];
                        const button = document.createElement('div');
                        button.className = 'channel-button';
                        button.textContent = pkg.name || key;
                        button.onclick = () => loadChannels(key, pkg.name || key);
                        homeContent.appendChild(button);
                    });
                } else {
                    homeContent.innerHTML = '<div class="loading">لا توجد باقات متاحة حالياً</div>';
                }
            }, (error) => {
                console.error('Error loading packages:', error);
                homeContent.innerHTML = '<div class="loading">حدث خطأ في تحميل القنوات</div>';
            });
        }

        // تحميل القنوات من Firebase
        function loadChannels(packageId, packageName) {
            currentCategory = packageId;
            document.getElementById('channelsTitle').textContent = packageName;

            const channelsContent = document.getElementById('channelsContent');
            channelsContent.innerHTML = '<div class="loading">جاري تحميل القنوات...</div>';

            database.ref('packages/' + packageId + '/channels').on('value', (snapshot) => {
                const channels = snapshot.val();
                channelsContent.innerHTML = '';

                if (channels) {
                    Object.keys(channels).forEach(key => {
                        const channel = channels[key];
                        const card = document.createElement('div');
                        card.className = 'channel-card';

                        if (channel.logo) {
                            const logo = document.createElement('img');
                            logo.className = 'channel-logo';
                            logo.src = channel.logo;
                            logo.alt = channel.name;
                            logo.onerror = function() {
                                this.style.display = 'none';
                            };
                            card.appendChild(logo);
                        }

                        const name = document.createElement('div');
                        name.className = 'channel-name';
                        name.textContent = channel.name || key;
                        card.appendChild(name);

                        card.onclick = () => playChannel(channel);
                        channelsContent.appendChild(card);
                    });
                } else {
                    channelsContent.innerHTML = '<div class="loading">لا توجد قنوات في هذه الباقة</div>';
                }

                showPage('channels');
            }, (error) => {
                console.error('Error loading channels:', error);
                channelsContent.innerHTML = '<div class="loading">حدث خطأ في تحميل القنوات</div>';
            });
        }

        // تحميل المباريات من Firebase
        function loadEvents() {
            const eventsContent = document.getElementById('eventsContent');
            eventsContent.innerHTML = '<div class="loading">جاري تحميل المباريات...</div>';

            database.ref('events').on('value', (snapshot) => {
                const events = snapshot.val();
                eventsContent.innerHTML = '';

                if (events) {
                    Object.keys(events).forEach(key => {
                        const event = events[key];
                        const card = document.createElement('div');
                        card.className = 'match-card';

                        card.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div style="text-align: center; flex: 1;">
                                    ${event.team1Logo ? `<img src="${event.team1Logo}" class="team-logo" alt="${event.team1}">` : ''}
                                    <div style="color: #764BA2; font-weight: bold; margin-top: 8px; font-size: 14px;">${event.team1 || ''}</div>
                                </div>
                                <div style="text-align: center; flex: 0 0 auto; padding: 0 20px;">
                                    <div class="status-badge">جارية الآن</div>
                                </div>
                                <div style="text-align: center; flex: 1;">
                                    ${event.team2Logo ? `<img src="${event.team2Logo}" class="team-logo" alt="${event.team2}">` : ''}
                                    <div style="color: #764BA2; font-weight: bold; margin-top: 8px; font-size: 14px;">${event.team2 || ''}</div>
                                </div>
                            </div>
                            ${event.league ? `
                                <div class="match-info">
                                    <i class="fas fa-trophy"></i>
                                    <span>${event.league}</span>
                                </div>
                            ` : ''}
                            ${event.commentator ? `
                                <div class="match-info">
                                    <i class="fas fa-microphone"></i>
                                    <span>علي محمد علي</span>
                                </div>
                            ` : ''}
                            ${event.channel ? `
                                <div class="match-info">
                                    <i class="fas fa-tv"></i>
                                    <span>${event.channel}</span>
                                </div>
                            ` : ''}
                        `;

                        card.onclick = () => playEvent(event);
                        eventsContent.appendChild(card);
                    });
                } else {
                    eventsContent.innerHTML = '<div class="loading">لا توجد مباريات مباشرة حالياً</div>';
                }
            }, (error) => {
                console.error('Error loading events:', error);
                eventsContent.innerHTML = '<div class="loading">حدث خطأ في تحميل المباريات</div>';
            });
        }

        // التنقل بين الصفحات
        function showPage(page) {
            document.getElementById('homePage').classList.add('hidden');
            document.getElementById('channelsPage').classList.add('hidden');
            document.getElementById('eventsPage').classList.add('hidden');

            if (page === 'home') {
                document.getElementById('homePage').classList.remove('hidden');
                updateBottomNav('home');
            } else if (page === 'channels') {
                document.getElementById('channelsPage').classList.remove('hidden');
            } else if (page === 'events') {
                document.getElementById('eventsPage').classList.remove('hidden');
                loadEvents();
                updateBottomNav('events');
            }
        }

        function backToHome() {
            showPage('home');
        }

        function updateBottomNav(active) {
            const buttons = document.querySelectorAll('.nav-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            if (active === 'home') {
                buttons[0].classList.add('active');
            } else if (active === 'events') {
                buttons[1].classList.add('active');
            }
        }

        function playChannel(channel) {
            showCustomAlert(`تشغيل قناة: ${channel.name}\n\nالرابط: ${channel.url || 'غير متوفر'}`);
        }

        function playEvent(event) {
            showCustomAlert(`تشغيل مباراة: ${event.team1} vs ${event.team2}\n\nالقناة: ${event.channel || 'غير متوفر'}`);
        }

        function toggleMenu() {
            showCustomAlert('القائمة الجانبية\n\nهذه الميزة قيد التطوير');
        }

        function searchChannels() {
            showCustomAlert('البحث\n\nهذه الميزة قيد التطوير');
        }

        // دالة مخصصة للتنبيهات بدلاً من alert()
        function showCustomAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;';

            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); max-width: 400px; width: 90%; margin: 20px;">
                    <p style="color: #333; margin-bottom: 20px; white-space: pre-line; line-height: 1.6;">${message}</p>
                    <div style="text-align: center;">
                        <button onclick="this.closest('div[style*=fixed]').remove()" style="padding: 12px 30px; background: #764BA2; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: bold;">حسناً</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            };
        }

        // تحميل البيانات عند بدء التطبيق
        window.addEventListener('load', () => {
            loadPackages();
        });
    </script>
</body>
</html>

